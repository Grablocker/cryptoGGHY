#include "./main.h"

int main(){

    ///* Encrypt
    uint32_t plaintext[16]={0x01234567, 0x89abcdef, 0xfedcba98, 0x76543210};
    uint8_t key[16]={0x01, 0x23, 0x45, 0x67, 0x89, 0xab, 0xcd, 0xef, 0xfe, 0xdc, 0xba, 0x98, 0x76, 0x54, 0x32, 0x10};
    
    uint32_t ciphertext[16];
    sm4_encrypt_block(plaintext, ciphertext, key);

    u32_output(ciphertext, 4);
    //*/

    /* Decrypt
    uint32_t ciphertext[16]={0x681edf34, 0xd206965e, 0x86b3e94f, 0x536e4246};
    uint8_t key[16]={0x01, 0x23, 0x45, 0x67, 0x89, 0xab, 0xcd, 0xef, 0xfe, 0xdc, 0xba, 0x98, 0x76, 0x54, 0x32, 0x10};
    
    uint32_t plaintext[16];
    sm4_decrypt_block(ciphertext, plaintext, key);

    u32_output(plaintext, 4);
    //*/

    return 0;
}